 RIGOROUS PHOTOGRAMMETRIC PROCESSING OF HIRISE STEREO IMAGES AND TOPOGRAPHIC MAPPING AT MARS EXPLORATION ROVER LANDING SITES. R. Li1, K. Di1, J. W. Hwangbo1, Y. Chen1 and the Athena Science Team,  1Mapping and GIS Laboratory, CEEGS, The Ohio State University, Columbus, OH, 43210-1275 (li.2@osu.edu)  Introduction: High-precision topographic information is critical to Mars surface exploration. Such information can be derived from both orbital and ground (rover) data. The availability of HiRISE (High Resolution Imaging Science Experiment) stereo images has enabled major technological progress in high-resolution imaging and, thus, in deriving topographic and morphological information for Mars surface exploration [1]. We have developed the rigorous photogrammetric model necessary for HiRISE stereo image processing and used it for topographic mapping in the Mars Exploration Rover (MER) 2003 mission [2]. Imaging Geometry of HiRISE: HiRISE is a pushbroom imaging sensor with exterior orientation (EO) parameters that change along image lines (Fig.1). For short segments of the orbital trajectory, 2nd-order polynomials can be used to model changes in the EO parameters with respect to time (Fig.2). Since all of the 14 CCD lines (10 red, 2 blue-green and 2 NIR) share the same EO parameters at a specific time, only one set of polynomial parameters is needed to model the EO parameters for all the CCD arrays. The orbit's initial positions and pointing angles are provided in the SPICE kernels. For any given ephemeris time, the EO parameters can be retrieved by interpolating the spacecraft's trajectory and pointing vectors.  HiRISE Image Matching: We have also developed a hierarchical stereo-matching process. Before processing, systematic strip noise in each raw HiRISE image is removed. Then, an image pyramid is constructed that consists of 5 levels (Fig.3). Starting with the original resolution, each of the subsequent levels is created by sub-sampling of the previous level. Interest points are generated by FÃ¶rstner operator at every image level. Matching starts from the images of lowest resolution; results are transferred to the next higher level, with more interest points being extracted and matched. After matching the highest-resolution images, relatively evenly distributed, matched interest points are selected as tie points between the stereo images. In the end, grid points are defined and matched to generate a DTM of the terrain. Bundle Adjustment of HiRISE Stereo Images: Based on the pushbroom rigorous sensor model, we have developed a method for bundle adjustment (BA) of HiRISE stereo images that removes or reduces measurement inconsistency and improves mapping precision. The BA is an iterative process based on the least-squares (LS) principle. Unknowns in this LS adjustment include the polynomial coefficients of the sensor model and the 3D ground positions of the tie points. Initial values of the polynomial coefficients are calculated by fitting the positions and pointing angles retrieved from the SPICE kernels. Using the HiRISE images of Victoria Crater TRA_000873_1780 and PSP_001414_1780, a total of 13,611 points were matched (Fig. 4) and 136 evenly distributed tie points along with 135 check points were automatically selected for BA. Before BA, the mean residual in the along-track direction was 24.6 pixels with a standard deviation of 0.77 pixel, and the mean residual in the cross-track direction was 0.017 pixel with a standard deviation of 0.23 pixel. After BA, the mean residual in the alongtrack and cross-track directions were 0.30 pixel and 0.0047 pixel, respectively, with standard deviations of 0.37 pixel and 0.024 pixel. Fig.5 shows the error vectors before and after BA. This improved precision ensures the high quality of the derived topographic and morphological information. Topographic Mapping at MER Sites: In addition to the stereo pair of Victoria Crater, we also processed a stereo pair of HiRISE images that cover the Home Plate area. We then used these products in MER operations for comparing with rover image derived DTMs. 3D ground points were calculated using the matched image points with the improved EO parameters. A DTM was then generated by interpolation of these 3D ground points using the Kriging method. Subsequently, an orthophoto was generated by back-projection of the DTM onto the original HiRISE image. Fig.6 shows a 3D model of the Home Plate area formed by draping the orthophoto on the DTM. These topographic products were very helpful in evaluation of possible routes for the rover from Home Plate to Von Braun during the MER mission operations.  Evaluation of Orbital Jitter Effect: Orbital jitter has been found in HiRISE's pointing data. For a long strip of 80,000 lines, we fitted the EO parameters using 3rd-order polynomials; residuals of positions show only rounding errors while residuals of pointing angles show the effect of jitter. Then we projected the footprint of the same CCD pixel (same column) on each line for the entire strip onto the Mars surface using both the EO parameters with jitter and the "ideal" EO parameters (3rdorder polynomial fitted). Comparing the two footprints on Mars surface (Fig.7), we can observe that the jitter  effect on X (cross track) is larger than that on Y (along track) and also that this effect can reach to 2 m for a long strip of 80,000 lines. We are currently comparing several methods for removing and/or reducing jitter effects. Results will be presented at the conference. References: [1] McEwen, A. et al. (2007), JGRPlanets, 112(E05S02). [2] Li, R. et al. (2007), 2007 AGU Fall Meeting.  Acknowledgements: Funding for this research by the NASA Applied Information System Research (AISR) Program is acknowledged.           Figure 1. Pushbroom geometric model of HiRISE.    Figure 2. Changes in HiRISE exterior orientations are modeled using 2nd-order polynomials with respect to image line (time).    Figure 3. The image matching strategy pyramid.   Figure 4. Automatic image matching and tie point selection at Victoria Crater.  Figure 5. Error vectors on the image before (left, 10 times exaggeration) and after (right, 100 times exaggeration) bundle adjustment at Victoria Crater.   Figure 6. 3D model generated from HiRISE stereo images at Home Plate.       Figure 7. Jitter effect of a point in X (left, cross track) and Y (right, along track) directions as projected onto the ground. Horizontal axes are image lines; vertical axes are the differences between positions in meters with and without jitter.  Z X Y MBF HiRISE camera frame 1/8  1/16 1/4 1/2  Correlation 
